<!DOCTYPE html>
<html lang="en">


  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="apple-touch-icon" sizes="76x76" href="./assets/img/apple-icon.png">
    <link rel="icon" type="image/png" href="./assets/img/favicon.png">
    <title>
      Poznań University of Technology
    </title>
    <!--     Fonts and icons     -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet" />
    <!-- CSS Files -->
    <link id="pagestyle" href="./assets/css/soft-design-system.css?v=1.0.5" rel="stylesheet" />
  </head>

<body class="index-page">
  <!-- Navbar -->
  <div class="container position-sticky z-index-sticky top-0">
    <div class="row">
      <div class="col-12">
        <nav class="navbar navbar-expand-lg  blur blur-rounded top-0 z-index-fixed shadow position-absolute my-3 py-2 start-0 end-0 mx-4">
          <div class="container-fluid">
            <a class="navbar-brand font-weight-bolder ms-sm-3" href="index.html" rel="tooltip" title="Designed and Coded by Creative Tim" data-placement="bottom">
              Poznań University of Technology
            </a>
          </div>
        </nav>
        <!-- End Navbar -->
      </div>
    </div>
  </div>
  <header class="header-2">
    <div class="page-header min-vh-50" style="background-image: url('./assets/img/curved-images/curved.jpg')">
      <div class="container">
        <div class="row">
          <div class="col-lg-7 text-center mx-auto">
            <h1 data-faculty-name class="text-white pt-3 mt-n5">Faculty of Computing and Telecommunications</h1>
          </div>
        </div>
      </div>
      <div class="position-absolute w-100 z-index-1 bottom-0">
        <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 40" preserveAspectRatio="none" shape-rendering="auto">
          <defs>
            <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
          </defs>
          <g class="moving-waves">
            <use xlink:href="#gentle-wave" x="48" y="-1" fill="rgba(255,255,255,0.40" />
            <use xlink:href="#gentle-wave" x="48" y="3" fill="rgba(255,255,255,0.35)" />
            <use xlink:href="#gentle-wave" x="48" y="5" fill="rgba(255,255,255,0.25)" />
            <use xlink:href="#gentle-wave" x="48" y="8" fill="rgba(255,255,255,0.20)" />
            <use xlink:href="#gentle-wave" x="48" y="13" fill="rgba(255,255,255,0.15)" />
            <use xlink:href="#gentle-wave" x="48" y="16" fill="rgba(255,255,255,0.95" />
          </g>
        </svg>
      </div>
    </div>
  </header>

  <div class="container">
    <div class="row">
      <div class="row justify-content-center text-center my-sm-5">
        <div class="col-lg-6">
          <h2 class="text-primary text-gradient">List of available courses</h2>
        </div>
      </div>
    </div>
    <div class="container py-3">
      <div class="row">
          <div class="row">
            <div class="col-lg-4 col-md-6 col-sm-3 d-flex justify-content-center">
              <select class="form-select" aria-label="selectDiplomas" id="diploma-select">
                <option selected>All degrees</option>
                <option value="BSC">Bachelor of Sciences</option>
                <option value="MASTER">Master</option>
                <option value="PHD">Doctor of Philosophy</option>
              </select>
            </div>
          </div>
      </div>
    </div>
    <section id="courses">
      <template id="course-card">
        <div class="col-lg-3" style="height: 24rem;">
          <div class="card shadow-lg" data-diploma="MASTER">
            <div class="card-header p-0 mx-3 mt-3 position-relative z-index-1">
              <div class="d-block blur-shadow-image">
                <img data-course-card-image src="assets/img/courses/MASTER.webp" alt="img-blur-shadow" class="img-fluid shadow rounded-3">
              </div>
              <div class="colored-shadow" style="background-image: url(&quot;assets/img/courses/MASTER.webp&quot;);"></div>
            </div>
            <div class="card-body">
              <a href="course.html" target="_blank" data-course-card-body-link>
                <h5 class="mt-3" data-course-card-title>
                  Software Development Studio 2
                </h5>
              </a>
            </div>
          </div>
        </div>
      </template>
    </section>

  <!-- -------   END PRE-FOOTER 2 - simple social line w/ title & 3 buttons    -------- -->
  <footer class="footer pt-5 mt-5">
    <hr class="horizontal dark mb-5">
    <div class="container">
      <div class=" row">
        <div class="col-md-3 mb-4 ms-auto">
          <div>
            <h6 class="text-gradient text-primary font-weight-bolder">Poznań University of Technology</h6>
          </div>
        </div>
        <div class="col-12">
          <div class="text-center">
            <p class="my-4 text-sm">
              All rights reserved. Copyright © <script>
                document.write(new Date().getFullYear())
              </script> Soft UI Design System by <a href="https://www.creative-tim.com" target="_blank">Creative Tim</a>.
            </p>
          </div>
        </div>
      </div>
    </div>
  </footer>
  <script type="text/javascript">
    const BASE_URL = 'http://localhost:8080';
    const FACULTY_URL = 'faculties/{facultyId}';
    const COURSES_URL = 'faculties/{facultyId}/courses';
    
    // get faculty id param
    const paramsString = window.location.search;
    let searchParams = new URLSearchParams(paramsString);
    if (searchParams.has('faculty') && searchParams.get('faculty')) {
      const facultyId = searchParams.get('faculty');
      let facultyUrl = FACULTY_URL.replace('{facultyId}', facultyId);
      let coursesUrl = COURSES_URL.replace('{facultyId}', facultyId);

      // Get faculty name
      fetch(`${BASE_URL}/${facultyUrl}`)
      .then(response => response.json())
      .then(faculty => {
        document.querySelector('[data-faculty-name]').textContent = `Faculty of ${faculty.name}`;
      })
      .catch(error => console.error('Request failed', error));

      // Get courses
      fetch(`${BASE_URL}/${coursesUrl}`)
      .then(response => response.json())
      .then(data => createCards(data, facultyId))
      .catch(error => console.error('Request failed', error));

      const diplomaSelect = document.getElementById("diploma-select");
      diplomaSelect.addEventListener("change", function() {
          const diploma = this.value;
          let coursesByDiplomaUrl = `${BASE_URL}/${coursesUrl}`;
          if (Array('BSC', 'MASTER', 'PHD').indexOf(diploma) >= 0) {
            coursesByDiplomaUrl += `?diploma=${diploma}`;
          }
        
        fetch(coursesByDiplomaUrl)
        .then(response => response.json())
        .then(data => {
          destroyCards();
          createCards(data, facultyId)
        })
        .catch(error => console.error('Request failed', error));
      });
    }
    
    /**
     * Create course cards with a card template
     */
    const nbCourseCardsByRow = 4;
    function createCards(courses, facultyId) {
      if ('content' in document.createElement('template')) {
        var coursesSection = document.querySelector("#courses");
        var template = document.querySelector('#course-card');
        var lastRow;

        courses.forEach((course, index) => {
          var clone = template.content.cloneNode(true);
          clone.querySelector('[data-diploma]').dataset.diploma = course.diploma;
          clone.querySelector('[data-course-card-title]').textContent = course.title;
          clone.querySelector('[data-course-card-image]').src = `assets/img/courses/${course.diploma}.webp`;
          clone.querySelector('[data-course-card-body-link]').href = `course.html?faculty=${facultyId}&id=${course.id}`;
          if (index % nbCourseCardsByRow == 0) {
            // create row
            lastRow = document.createElement("div");
            coursesSection.appendChild(lastRow).className = "row align-items-center course-row";
          }
          // Add new course card
          lastRow.appendChild(clone);
        });
      } else {
        console.error('Template not supported!')
      // Find another way to add the rows to the table because
      // the HTML template element is not supported.
      }
    }

    function destroyCards() {
      let courseRows = document.querySelectorAll('.course-row');
      courseRows.forEach(courseRow => {
        courseRow.innerHTML = '';
      });
    }
  </script>
</body>

</html>
